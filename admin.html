<!DOCTYPE html>
<html>
  <head>
    <style>
      /* Your CSS here */
    </style>
    <script>
      function fetchBookingData() {
        fetch('https://script.google.com/macros/s/AKfycbxqYDuIl-9aFJXJmq0QzshgDrSEg5h9_ghFvA2BpD8t4U39bvY0UkkoS1zE7eU5aFTy/exec', {
          method: 'GET',
          mode: 'no-cors',  // This prevents CORS issues but limits response visibility
        })  // Replace with your deployed Web App URL
          .then(response => response.json())
          .then(data => {
            const tableBody = document.getElementById('bookingTable').getElementsByTagName('tbody')[0];
            tableBody.innerHTML = '';  // Clear the table before adding new data
            data.forEach(detail => {
              const row = tableBody.insertRow();
              row.insertCell(0).innerText = detail.name;
              row.insertCell(1).innerText = detail.email;
              row.insertCell(2).innerText = detail.phone;
              row.insertCell(3).innerText = detail.date;
              row.insertCell(4).innerText = detail.time;
              row.insertCell(5).innerText = detail.guests;
              row.insertCell(6).innerText = detail.currentDateTime;
            });
          })
          .catch(error => console.error('Error fetching data:', error));
      }
    </script>
  </head>
  <body>
    <div class="header">Admin Booking Dashboard</div>
    <table id="bookingTable">
      <thead>
        <tr>
          <th>Name</th>
          <th>Email</th>
          <th>Phone</th>
          <th>Date</th>
          <th>Time</th>
          <th>Guests</th>
          <th>Submitted At</th>
        </tr>
      </thead>
      <tbody>
        <!-- Data will be inserted here dynamically -->
      </tbody>
    </table>

    <button onclick="fetchBookingData()">Load Data</button>
  </body>
</html>
