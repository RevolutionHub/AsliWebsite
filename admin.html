<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="admin.css">
  </head>
  <body>
    <div class="header">Admin Booking Dashboard</div>
    <table id="bookingTable">
      <thead>
        <tr>
          <th>Name</th>
          <th>Email</th>
          <th>Phone</th>
          <th>Date</th>
          <th>Time</th>
          <th>Guests</th>
          <th>Submitted At</th>
        </tr>
      </thead>
      <tbody>
        <!-- Data will be inserted here dynamically -->
      </tbody>
    </table>
    
    <script>
      // Fetch the booking data from Apps Script and populate the table
      function fetchBookingData() {
        google.script.run.withSuccessHandler(renderTable).getBookingData();
      }

      // Render the table
      function renderTable(bookingDetails) {
        const tableBody = document.getElementById('bookingTable').getElementsByTagName('tbody')[0];
        bookingDetails.forEach(detail => {
          const row = tableBody.insertRow();
          row.insertCell(0).innerText = detail.name;
          row.insertCell(1).innerText = detail.email;
          row.insertCell(2).innerText = detail.phone;
          row.insertCell(3).innerText = detail.date;
          row.insertCell(4).innerText = detail.time;
          row.insertCell(5).innerText = detail.guests;
          row.insertCell(6).innerText = detail.currentDateTime;
        });
      }

      // Load data when the page is loaded
      window.onload = fetchBookingData;
    </script>
  </body>
</html>
